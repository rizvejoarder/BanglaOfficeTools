import{c as fe,g as de}from"./pdfjs-CwH_0J_o.js";import{P as he,T as pe,F as ge,a as ve}from"./docx-BP6L-9zv.js";import{F as ye}from"./FileSaver.min-BjtJenfE.js";import{s as me,p as we}from"./banglaTextProcessor-Co2c3PQM.js";var Le={exports:{}};(function(o){var i=function(s){var l=Object.prototype,y=l.hasOwnProperty,b=Object.defineProperty||function(r,e,n){r[e]=n.value},p,g=typeof Symbol=="function"?Symbol:{},E=g.iterator||"@@iterator",k=g.asyncIterator||"@@asyncIterator",S=g.toStringTag||"@@toStringTag";function u(r,e,n){return Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{u({},"")}catch{u=function(e,n,c){return e[n]=c}}function m(r,e,n,c){var t=e&&e.prototype instanceof j?e:j,a=Object.create(t.prototype),f=new K(c||[]);return b(a,"_invoke",{value:Z(r,n,f)}),a}s.wrap=m;function T(r,e,n){try{return{type:"normal",arg:r.call(e,n)}}catch(c){return{type:"throw",arg:c}}}var _="suspendedStart",R="suspendedYield",N="executing",I="completed",w={};function j(){}function C(){}function L(){}var z={};u(z,E,function(){return this});var B=Object.getPrototypeOf,W=B&&B(B(H([])));W&&W!==l&&y.call(W,E)&&(z=W);var P=L.prototype=j.prototype=Object.create(z);C.prototype=L,b(P,"constructor",{value:L,configurable:!0}),b(L,"constructor",{value:C,configurable:!0}),C.displayName=u(L,S,"GeneratorFunction");function J(r){["next","throw","return"].forEach(function(e){u(r,e,function(n){return this._invoke(e,n)})})}s.isGeneratorFunction=function(r){var e=typeof r=="function"&&r.constructor;return e?e===C||(e.displayName||e.name)==="GeneratorFunction":!1},s.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,L):(r.__proto__=L,u(r,S,"GeneratorFunction")),r.prototype=Object.create(P),r},s.awrap=function(r){return{__await:r}};function D(r,e){function n(a,f,d,h){var v=T(r[a],r,f);if(v.type==="throw")h(v.arg);else{var M=v.arg,A=M.value;return A&&typeof A=="object"&&y.call(A,"__await")?e.resolve(A.__await).then(function($){n("next",$,d,h)},function($){n("throw",$,d,h)}):e.resolve(A).then(function($){M.value=$,d(M)},function($){return n("throw",$,d,h)})}}var c;function t(a,f){function d(){return new e(function(h,v){n(a,f,h,v)})}return c=c?c.then(d,d):d()}b(this,"_invoke",{value:t})}J(D.prototype),u(D.prototype,k,function(){return this}),s.AsyncIterator=D,s.async=function(r,e,n,c,t){t===void 0&&(t=Promise);var a=new D(m(r,e,n,c),t);return s.isGeneratorFunction(e)?a:a.next().then(function(f){return f.done?f.value:a.next()})};function Z(r,e,n){var c=_;return function(a,f){if(c===N)throw new Error("Generator is already running");if(c===I){if(a==="throw")throw f;return q()}for(n.method=a,n.arg=f;;){var d=n.delegate;if(d){var h=Y(d,n);if(h){if(h===w)continue;return h}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(c===_)throw c=I,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);c=N;var v=T(r,e,n);if(v.type==="normal"){if(c=n.done?I:R,v.arg===w)continue;return{value:v.arg,done:n.done}}else v.type==="throw"&&(c=I,n.method="throw",n.arg=v.arg)}}}function Y(r,e){var n=e.method,c=r.iterator[n];if(c===p)return e.delegate=null,n==="throw"&&r.iterator.return&&(e.method="return",e.arg=p,Y(r,e),e.method==="throw")||n!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var t=T(c,r.iterator,e.arg);if(t.type==="throw")return e.method="throw",e.arg=t.arg,e.delegate=null,w;var a=t.arg;if(!a)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,w;if(a.done)e[r.resultName]=a.value,e.next=r.nextLoc,e.method!=="return"&&(e.method="next",e.arg=p);else return a;return e.delegate=null,w}J(P),u(P,S,"Generator"),u(P,E,function(){return this}),u(P,"toString",function(){return"[object Generator]"});function Q(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function G(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function K(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(Q,this),this.reset(!0)}s.keys=function(r){var e=Object(r),n=[];for(var c in e)n.push(c);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}};function H(r){if(r){var e=r[E];if(e)return e.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length)){var n=-1,c=function t(){for(;++n<r.length;)if(y.call(r,n))return t.value=r[n],t.done=!1,t;return t.value=p,t.done=!0,t};return c.next=c}}return{next:q}}s.values=H;function q(){return{value:p,done:!0}}return K.prototype={constructor:K,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.method="next",this.arg=p,this.tryEntries.forEach(G),!r)for(var e in this)e.charAt(0)==="t"&&y.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=p)},stop:function(){this.done=!0;var r=this.tryEntries[0],e=r.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(h,v){return a.type="throw",a.arg=r,e.next=h,v&&(e.method="next",e.arg=p),!!v}for(var c=this.tryEntries.length-1;c>=0;--c){var t=this.tryEntries[c],a=t.completion;if(t.tryLoc==="root")return n("end");if(t.tryLoc<=this.prev){var f=y.call(t,"catchLoc"),d=y.call(t,"finallyLoc");if(f&&d){if(this.prev<t.catchLoc)return n(t.catchLoc,!0);if(this.prev<t.finallyLoc)return n(t.finallyLoc)}else if(f){if(this.prev<t.catchLoc)return n(t.catchLoc,!0)}else if(d){if(this.prev<t.finallyLoc)return n(t.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(r,e){for(var n=this.tryEntries.length-1;n>=0;--n){var c=this.tryEntries[n];if(c.tryLoc<=this.prev&&y.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var t=c;break}}t&&(r==="break"||r==="continue")&&t.tryLoc<=e&&e<=t.finallyLoc&&(t=null);var a=t?t.completion:{};return a.type=r,a.arg=e,t?(this.method="next",this.next=t.finallyLoc,w):this.complete(a)},complete:function(r,e){if(r.type==="throw")throw r.arg;return r.type==="break"||r.type==="continue"?this.next=r.arg:r.type==="return"?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):r.type==="normal"&&e&&(this.next=e),w},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===r)return this.complete(n.completion,n.afterLoc),G(n),w}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===r){var c=n.completion;if(c.type==="throw"){var t=c.arg;G(n)}return t}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:H(r),resultName:e,nextLoc:n},this.method==="next"&&(this.arg=p),w}},s}(o.exports);try{regeneratorRuntime=i}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}})(Le);var ee=(o,i)=>`${o}-${i}-${Math.random().toString(16).slice(3,8)}`;const Ee=ee;let re=0;var se=({id:o,action:i,payload:s={}})=>{let l=o;return typeof l>"u"&&(l=Ee("Job",re),re+=1),{id:l,action:i,payload:s}},U={};let te=!1;U.logging=te;U.setLogging=o=>{te=o};U.log=(...o)=>te?console.log.apply(void 0,o):null;const be=se,{log:V}=U,Se=ee;let oe=0;var Oe=()=>{const o=Se("Scheduler",oe),i={},s={};let l=[];oe+=1;const y=()=>l.length,b=()=>Object.keys(i).length,p=()=>{if(l.length!==0){const u=Object.keys(i);for(let m=0;m<u.length;m+=1)if(typeof s[u[m]]>"u"){l[0](i[u[m]]);break}}},g=(u,m)=>new Promise((T,_)=>{const R=be({action:u,payload:m});l.push(async N=>{l.shift(),s[N.id]=R;try{T(await N[u].apply(void 0,[...m,R.id]))}catch(I){_(I)}finally{delete s[N.id],p()}}),V(`[${o}]: Add ${R.id} to JobQueue`),V(`[${o}]: JobQueue length=${l.length}`),p()});return{addWorker:u=>(i[u.id]=u,V(`[${o}]: Add ${u.id}`),V(`[${o}]: Number of workers=${b()}`),p(),u.id),addJob:async(u,...m)=>{if(b()===0)throw Error(`[${o}]: You need to have at least one worker before adding jobs`);return g(u,m)},terminate:async()=>{Object.keys(i).forEach(async u=>{await i[u].terminate()}),l=[]},getQueueLen:y,getNumWorkers:b}};function ke(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var Te=ke;const Ae=Te;var $e=o=>{const i={};return typeof WorkerGlobalScope<"u"?i.type="webworker":Ae()?i.type="electron":typeof document=="object"?i.type="browser":typeof process=="object"&&typeof fe=="function"&&(i.type="node"),typeof o>"u"?i:i[o]};const _e=$e("type")==="browser",Re=_e?o=>new URL(o,window.location.href).href:o=>o;var Ne=o=>{const i={...o};return["corePath","workerPath","langPath"].forEach(s=>{o[s]&&(i[s]=Re(i[s]))}),i},Ie=o=>{const i=[],s=[],l=[],y=[],b=[];return o.blocks&&o.blocks.forEach(p=>{p.paragraphs.forEach(g=>{g.lines.forEach(E=>{E.words.forEach(k=>{k.symbols.forEach(S=>{b.push({...S,page:o,block:p,paragraph:g,line:E,word:k})}),y.push({...k,page:o,block:p,paragraph:g,line:E})}),l.push({...E,page:o,block:p,paragraph:g})}),s.push({...g,page:o,block:p})}),i.push({...p,page:o})}),{...o,blocks:i,paragraphs:s,lines:l,words:y,symbols:b}},ce={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const Pe="5.1.1",Me={version:Pe};var Ce={workerBlobURL:!0,logger:()=>{}};const Ge=Me.version,Fe=Ce;var je={...Fe,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Ge}/dist/worker.min.js`},We=({workerPath:o,workerBlobURL:i})=>{let s;if(Blob&&URL&&i){const l=new Blob([`importScripts("${o}");`],{type:"application/javascript"});s=new Worker(URL.createObjectURL(l))}else s=new Worker(o);return s},De=o=>{o.terminate()},Ue=(o,i)=>{o.onmessage=({data:s})=>{i(s)}},ze=async(o,i)=>{o.postMessage(i)};const X=o=>new Promise((i,s)=>{const l=new FileReader;l.onload=()=>{i(l.result)},l.onerror=({target:{error:{code:y}}})=>{s(Error(`File could not be read! Code=${y}`))},l.readAsArrayBuffer(o)}),x=async o=>{let i=o;if(typeof o>"u")return"undefined";if(typeof o=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(o)?i=atob(o.split(",")[1]).split("").map(s=>s.charCodeAt(0)):i=await(await fetch(o)).arrayBuffer();else if(typeof HTMLElement<"u"&&o instanceof HTMLElement)o.tagName==="IMG"&&(i=await x(o.src)),o.tagName==="VIDEO"&&(i=await x(o.poster)),o.tagName==="CANVAS"&&await new Promise(s=>{o.toBlob(async l=>{i=await X(l),s()})});else if(typeof OffscreenCanvas<"u"&&o instanceof OffscreenCanvas){const s=await o.convertToBlob();i=await X(s)}else(o instanceof File||o instanceof Blob)&&(i=await X(o));return new Uint8Array(i)};var Be=x;const Ye=je,Ke=We,He=De,Je=Ue,qe=ze,Ve=Be;var Ze={defaultOptions:Ye,spawnWorker:Ke,terminateWorker:He,onMessage:Je,send:qe,loadImage:Ve};const Qe=Ne,Xe=Ie,O=se,{log:ne}=U,xe=ee,F=ce,{defaultOptions:et,spawnWorker:tt,terminateWorker:rt,onMessage:ot,loadImage:ae,send:nt}=Ze;let ie=0;var le=async(o="eng",i=F.LSTM_ONLY,s={},l={})=>{const y=xe("Worker",ie),{logger:b,errorHandler:p,...g}=Qe({...et,...s}),E={},k={},S=typeof o=="string"?o.split("+"):o;let u=i,m=l;const T=[F.DEFAULT,F.LSTM_ONLY].includes(i)&&!g.legacyCore;let _,R;const N=new Promise((t,a)=>{R=t,_=a}),I=t=>{_(t.message)};let w=tt(g);w.onerror=I,ie+=1;const j=(t,a)=>{E[t]=a},C=(t,a)=>{k[t]=a},L=({id:t,action:a,payload:f})=>new Promise((d,h)=>{ne(`[${y}]: Start ${t}, action=${a}`);const v=`${a}-${t}`;j(v,d),C(v,h),nt(w,{workerId:y,jobId:t,action:a,payload:f})}),z=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),B=t=>L(O({id:t,action:"load",payload:{options:{lstmOnly:T,corePath:g.corePath,logging:g.logging}}})),W=(t,a,f)=>L(O({id:f,action:"FS",payload:{method:"writeFile",args:[t,a]}})),P=(t,a)=>L(O({id:a,action:"FS",payload:{method:"readFile",args:[t,{encoding:"utf8"}]}})),J=(t,a)=>L(O({id:a,action:"FS",payload:{method:"unlink",args:[t]}})),D=(t,a,f)=>L(O({id:f,action:"FS",payload:{method:t,args:a}})),Z=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),Y=(t,a)=>L(O({id:a,action:"loadLanguage",payload:{langs:t,options:{langPath:g.langPath,dataPath:g.dataPath,cachePath:g.cachePath,cacheMethod:g.cacheMethod,gzip:g.gzip,lstmOnly:[F.DEFAULT,F.LSTM_ONLY].includes(u)&&!g.legacyLang}}})),Q=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),G=(t,a,f,d)=>L(O({id:d,action:"initialize",payload:{langs:t,oem:a,config:f}})),K=(t="eng",a,f,d)=>{if(T&&[F.TESSERACT_ONLY,F.TESSERACT_LSTM_COMBINED].includes(a))throw Error("Legacy model requested but code missing.");const h=a||u;u=h;const v=f||m;m=v;const A=(typeof t=="string"?t.split("+"):t).filter($=>!S.includes($));return S.push(...A),A.length>0?Y(A,d).then(()=>G(t,h,v,d)):G(t,h,v,d)},H=(t={},a)=>L(O({id:a,action:"setParameters",payload:{params:t}})),q=async(t,a={},f={blocks:!0,text:!0,hocr:!0,tsv:!0},d)=>L(O({id:d,action:"recognize",payload:{image:await ae(t),options:a,output:f}})),r=(t="Tesseract OCR Result",a=!1,f)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),L(O({id:f,action:"getPDF",payload:{title:t,textonly:a}}))),e=async(t,a)=>{if(T)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return L(O({id:a,action:"detect",payload:{image:await ae(t)}}))},n=async()=>(w!==null&&(rt(w),w=null),Promise.resolve());ot(w,({workerId:t,jobId:a,status:f,action:d,data:h})=>{const v=`${d}-${a}`;if(f==="resolve"){ne(`[${t}]: Complete ${a}`);let M=h;d==="recognize"?M=Xe(h):d==="getPDF"&&(M=Array.from({...h,length:Object.keys(h).length})),E[v]({jobId:a,data:M})}else if(f==="reject")if(k[v](h),d==="load"&&_(h),p)p(h);else throw Error(h);else f==="progress"&&b({...h,userJobId:a})});const c={id:y,worker:w,setResolve:j,setReject:C,load:z,writeText:W,readText:P,removeFile:J,FS:D,loadLanguage:Z,initialize:Q,reinitialize:K,setParameters:H,recognize:q,getPDF:r,detect:e,terminate:n};return B().then(()=>Y(o)).then(()=>G(o,i,l)).then(()=>R(c)).catch(()=>{}),N};const ue=le,at=async(o,i,s)=>{const l=await ue(i,1,s);return l.recognize(o).finally(async()=>{await l.terminate()})},it=async(o,i)=>{const s=await ue("osd",0,i);return s.detect(o).finally(async()=>{await s.terminate()})};var st={recognize:at,detect:it},ct={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},lt={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const ut=Oe,ft=le,dt=st,ht=ct,pt=ce,gt=lt,{setLogging:vt}=U;var yt={languages:ht,OEM:pt,PSM:gt,createScheduler:ut,createWorker:ft,setLogging:vt,...dt};const mt=de(yt),St=async(o,i=()=>{},s=!0)=>{try{i("ছবি প্রক্রিয়াকরণ শুরু হচ্ছে...");const l=await mt.recognize(o,"ben+eng",{logger:u=>{if(u.status==="recognizing text"){const m=Math.round(u.progress*100);i(`লেখা শনাক্ত করা হচ্ছে: ${m}%`)}}});i("লেখা প্রস্তুত করা হচ্ছে...");const{data:{text:y}}=l;if(!y||y.trim().length===0)throw new Error("ছবি থেকে কোনো লেখা পাওয়া যায়নি।");const p=me(y).map(u=>{const m=we(u);return new he({children:[new pe({text:m.text,font:m.font,size:m.size})]})}),g=new ge({sections:[{children:p}]});i("Word ফাইল তৈরি করা হচ্ছে...");const E=await ve.toBlob(g),S=`${o.name.replace(/\.[^/.]+$/,"")}.docx`;return s&&ye.saveAs(E,S),{success:!0,message:"সফলভাবে ছবি থেকে Word-এ রূপান্তরিত হয়েছে।",fileName:S,blob:E}}catch(l){throw console.error("Image to Word conversion error:",l),new Error(`ছবি থেকে Word রূপান্তরে সমস্যা হয়েছে: ${l.message}`)}};export{St as convertImageToWord};
