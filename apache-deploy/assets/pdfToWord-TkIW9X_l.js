import"./pdfjs-CwH_0J_o.js";import{P as d,T as w,F as T,a as b}from"./docx-BP6L-9zv.js";import"./FileSaver.min-BjtJenfE.js";import{l as B}from"./pdfHelper-DbM3en0t.js";import{s as F,p as $}from"./banglaTextProcessor-Co2c3PQM.js";const R=async(l,t=()=>{})=>{try{t("পিডিএফ ফাইল প্রস্তুত করা হচ্ছে...");const o=await l.arrayBuffer();t("পিডিএফ ডকুমেন্ট লোড করা হচ্ছে...");const m=await B(o),n=m.numPages;t(`পিডিএফ লোড হয়েছে। মোট পৃষ্ঠা: ${n}`);let a="";const s=[];for(let e=1;e<=n;e++){t(`পৃষ্ঠা ${e}/${n} থেকে লেখা বের করা হচ্ছে...`);const c=(await(await m.getPage(e)).getTextContent()).items.map(i=>i.str).join(" ").trim();if(c){a+=c+`

`,e>1&&s.push(new d({children:[new w({text:"",break:1})]}));const i=F(c);for(const p of i)if(p.trim()){const r=$(p);s.push(new d({children:[new w({text:r.text,font:r.font,size:r.size,rightToLeft:r.rightToLeft})]}))}}}if(!a.trim())throw new Error("পিডিএফ থেকে কোনো লেখা পাওয়া যায়নি। এটি একটি স্ক্যান করা ডকুমেন্ট হতে পারে।");t("ওয়ার্ড ডকুমেন্ট তৈরি করা হচ্ছে...");const g=new T({sections:[{children:s}]}),x=await b.toBlob(g),u=`${l.name.replace(".pdf","")}-text.docx`;t("সম্পন্ন! লেখা বের করে ওয়ার্ড ফাইল তৈরি হয়েছে।");const f=new Blob([x],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),h=URL.createObjectURL(f);return{success:!0,message:`সফলভাবে ${n} পৃষ্ঠা থেকে লেখা বের করে ওয়ার্ড ফাইল তৈরি হয়েছে।`,filename:u,downloadUrl:h,blob:f,textLength:a.length}}catch(o){throw console.error("PDF to Word conversion error:",o),new Error(`পিডিএফ থেকে ওয়ার্ড রূপান্তরে সমস্যা হয়েছে: ${o.message}`)}};export{R as convertPdfToWord};
